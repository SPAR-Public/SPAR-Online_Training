/*
 * Copyright (c) 2022, SPAR-Internal
 * All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */


/******************************************************************************
*
* Copyright (C) 2009 - 2014 Xilinx, Inc.  All rights reserved.
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* Use of the Software is limited solely to applications:
* (a) running on a Xilinx device, or
* (b) that interact with a Xilinx device through a bus or interconnect.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
* XILINX  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF
* OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* Except as contained in this notice, the name of the Xilinx shall not be used
* in advertising or otherwise to promote the sale, use or other dealings in
* this Software without prior written authorization from Xilinx.
*
******************************************************************************/

/*
 * helloworld.c: simple test application
 *
 * This application configures UART 16550 to baud rate 9600.
 * PS7 UART (Zynq) is not initialized by this application, since
 * bootrom/bsp configures it to baud rate 115200
 *
 * ------------------------------------------------
 * | UART TYPE   BAUD RATE                        |
 * ------------------------------------------------
 *   uartns550   9600
 *   uartlite    Configurable only in HW design
 *   ps7_uart    115200 (configured by bootrom/bsp)
 */

#include <stdio.h>
#include "platform.h"
#include "xil_printf.h"
#include <stdlib.h>
#include <stdint.h>
#include "platform.h"
#include "Bit_Serial.h"
#include "xparameters.h"
#include "microblaze_sleep.h"
//#include "xtmrctr.h"
#include <inttypes.h>
#include "xbasic_types.h"
#include "math.h"

#define MAX_LEN 32
#define FIXED_POINT_FRACTIONAL_BITS 16

#define Array_dim  1
#define Tile_dim  13
#define divide_size_W 50
#define divide_size_U 20
#define m1 20						//size of hidden layers
#define p 50							//size of inputs
#define q 1							//size of outputs
#define epoch 1

int ShL_cnt = 0;
int ShR_cnt = 0;
int ShN_cnt = 0;
int ShS_cnt = 0;
int mult_cnt = 0;
int add_cnt = 0;
int sub_cnt = 0;

//Function prototypes
int execute(int opcode, int rd, int rs1, int rs2);
int readRAM(int address);
int getbit(int n, int k);
void getTranspose(int* ram, int* reg);
void printArray(int* arr, int size);
void getData(int* arr, int address);
unsigned char Test(int64_t* rd_reg, int64_t* rs1_reg, int64_t* rs2_reg, char operation);
void WRITE(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int ADDRA, int ADDRB, int DIA, int DIB);
int READ(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int ADDRA, int ADDRB);
int printReg(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int PE, int reg);
int getTrans(int* ram);
void printRegFile(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int number_of_regs);
void WRITE_REG(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int PE, int reg, unsigned int data);
unsigned int READ_REG(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int PE, int reg);
//Fixed-point Format: 11.5 (16-bit)
typedef int32_t fixed_point_t;

//Converts double to 11.5 format
fixed_point_t float_to_fixed(double input);

int LEN = MAX_LEN << 24;


int main()
{
	init_platform();
	cleanup_platform();

	printf("Program Started...\n\n\r");

	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG2_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG7_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG3_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000000+LEN);

	//reset = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);

	//reset all the registers in the array to zero
	int i, j, k, l, e, addra;
	for( i = 0; i < Array_dim; i++){
		for( j = 0; j < Array_dim; j++){
			for( k = 0; k < Tile_dim; k++){
				for( l = 0; l < Tile_dim; l++){
					for( addra = 0; addra < 32 * 32; addra++){
						WRITE(i, j, k, l, addra, 0, 0, 0);
					}
				}
			}
		}
	}
	printf("RESET REGISTERS IS DONE! \n");

	static int W1[m1][p];
	static int W2[q][m1];
	static int b1[m1][1];
	static int b2[q][1];
	static int Y[q][1];
	static int alpha[Array_dim * Tile_dim * 4][Array_dim * Tile_dim * 4];

	static int X[p][1] = {	{0x00010000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},
							{0x00010000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},
							{0x00010000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},
							{0x00010000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},
							{0x00010000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000},{0x00000000},{0x00010000},{0x00000000}
							};

	static float W1_f[m1][p] = {
		{1.446763,0.924237,0.310388,-0.09322,0.459867,0.881474,-1.230661,1.320681,1.147092,0.741186,1.889903,-0.805029,0.058972,-0.941609,-0.352171,0.233198,0.115682,-0.650702,-1.43234,-1.416366,1.000518,-0.651237,1.535318,1.755552,0.785266,-1.036145,1.942729,-1.888867,-0.687853,-0.053735,-1.773855,-1.734285,-0.474942,-1.860153,-1.407302,-0.284758,-1.478223,1.788578,0.096439,1.617945,-0.049874,1.545371,-1.504248,-1.363996,-1.232755,1.792681,-1.051047,-1.674881,-1.665996,-1.682677},
		{-0.509193,1.636455,-1.731679,0.494294,0.401526,1.845859,-0.160772,1.467691,-0.431547,1.421778,0.697746,0.351968,0.196894,-0.063937,-1.292748,1.589975,1.557175,1.696727,0.438233,-1.943366,1.09337,-0.373149,1.157352,-0.073517,-0.022834,-0.405776,-0.766992,1.820017,-0.946951,0.891911,-0.551143,1.524731,0.188033,1.485936,-1.576526,-1.237523,-0.790696,0.141436,0.810678,-0.472194,1.133375,-1.924466,0.231412,0.889767,-0.977697,1.727409,1.611035,-0.77562,1.914417,0.778111},
		{-1.67465,-1.75683,-1.609236,0.345743,-1.071416,0.149672,1.324641,-1.748513,-0.189741,-1.642444,-1.07859,1.592748,-0.552874,0.851206,-0.86939,1.481665,0.150736,-0.658844,1.32391,-0.019095,0.294101,0.731772,-1.334912,-1.485844,1.120472,0.974617,1.813906,1.945169,-1.351615,0.278588,1.035327,1.381439,0.213892,1.203574,0.227818,-0.888103,1.28321,-0.38605,-1.228119,1.65602,-0.589784,0.677945,1.040475,-0.537821,0.11288,-0.22229,1.941812,-1.855999,1.692046,0.478623},
		{-0.296772,-1.102397,0.662379,1.562708,0.11523,0.490948,0.664066,-0.677916,-0.235916,-1.220592,1.235091,0.063398,0.668648,0.505566,1.625896,-0.309022,-1.095525,-0.158908,0.264815,-1.403535,1.680499,-0.81651,1.472584,-1.54612,-1.942744,-1.187132,1.553863,-0.976732,-1.279797,-0.250089,0.34068,1.017826,-1.46543,1.255065,0.141654,0.539051,1.665764,-0.070124,1.142539,1.339193,-0.209308,0.915224,1.559839,-1.639153,1.993354,0.165886,1.486841,1.986437,-0.847489,-0.57668},
		{0.690318,-0.848277,-1.863057,1.524862,1.506765,0.687357,-1.464768,-1.135884,1.996918,0.83822,0.81288,0.397947,1.137038,0.075609,1.769402,0.478998,0.159971,-0.224433,0.463779,1.519145,0.49279,-1.529839,-0.462764,0.918006,1.909987,-1.35538,-0.277584,-1.421065,-0.970522,-1.387505,0.30519,-1.852315,1.334508,1.395222,-1.860203,-0.300319,1.45189,-0.446393,0.210497,-1.730626,-0.032647,0.735059,0.654365,1.218629,-0.953174,-1.010199,0.51948,-1.423897,-1.398805,1.715972},
		{0.729093,-1.377115,-1.127541,-0.254589,1.19735,-0.184266,0.587563,-0.712697,-1.85196,-1.207248,-0.027751,0.585548,1.683752,0.997867,1.159787,-1.79366,-0.692073,-0.560387,-0.291482,1.507109,-1.926006,1.868047,1.498746,0.002773,0.391516,-1.183831,0.722772,1.24939,-0.250423,-1.602425,-1.023953,-1.570538,-1.691042,0.818144,-1.881128,0.412389,-0.847026,1.866585,0.109995,-1.02465,-1.080552,-0.481272,0.947628,1.067174,0.065035,1.174561,-1.973886,-0.973197,1.439923,0.791857},
		{1.809143,-1.810963,-1.883114,1.270665,1.399929,1.800233,-1.901351,0.745705,-0.241406,-0.934411,1.935176,-0.146552,1.624474,1.268791,1.963617,1.011687,-0.131642,-0.793477,1.27583,-1.967676,-0.185949,1.17579,-1.530382,0.302064,0.109705,-1.272261,0.579169,-1.228718,1.434895,1.372697,-0.900878,-0.875325,-0.644955,-1.943694,-1.566651,1.996772,-1.96788,0.584267,1.892616,0.90239,1.596811,-0.131946,1.789049,-0.686176,-1.213655,-0.756384,0.926252,1.842432,-1.096921,0.895818},
		{-0.578477,1.401345,1.33056,1.187055,-1.408174,-1.074748,-0.656129,0.552731,-0.814075,-0.216559,1.700366,0.702403,1.501518,0.071697,-0.277055,-1.597686,1.496981,-0.244369,-1.22071,-1.645521,-1.766366,0.983002,1.999758,-1.110808,-1.62079,1.399647,0.826713,1.035568,1.297121,0.700179,-1.073894,1.350453,1.740998,-0.648161,0.155993,1.524383,-0.657499,-0.667096,-1.304171,-0.812314,1.057669,1.258464,1.052126,-1.714106,0.514599,-1.1163,-0.924881,-0.454825,0.289315,-0.122133},
		{1.162181,-0.725456,1.290299,-0.008516,0.570481,-0.168128,-1.86234,0.055704,0.328222,1.359395,-1.144113,-0.530617,-0.99175,1.518196,-0.894097,-1.155123,-1.741308,-0.931469,1.860463,1.307275,0.514138,-1.765435,0.292048,-0.075983,1.160534,0.87649,-1.896359,-0.577412,0.046879,1.90618,-0.605927,1.774024,0.738038,-0.394093,-1.711576,-1.837577,0.043662,-0.980433,1.398787,0.539299,-1.465687,0.038023,0.239435,-1.534535,0.786869,0.762508,0.805747,0.297482,0.858902,0.383184},
		{-0.72552,-1.457723,-1.064041,0.416778,1.353202,0.434299,-1.919029,-0.569093,1.18405,0.148868,0.061506,0.673121,0.027734,-0.799517,-0.046962,-1.777108,1.062801,0.252118,1.622698,1.700779,1.911249,0.077254,-1.43698,1.507037,0.574893,1.407653,-1.460692,1.467962,-1.699364,0.021834,1.648629,0.116491,-0.365731,-1.208553,1.108747,-0.064003,-1.721033,1.591698,-0.070742,-1.128257,-0.56222,1.638825,1.253399,1.711148,1.813388,1.871191,-1.873446,1.277848,0.201231,0.20118},
		{1.702954,-0.487962,1.132782,0.421182,0.669568,1.605948,1.695457,1.621016,1.235922,1.653385,1.334844,-1.056071,-1.010026,-0.695589,-0.414437,-1.012439,-1.593238,-0.010363,-0.123326,-1.573004,-1.522161,0.759836,-0.287009,-0.026189,1.727472,0.548832,-1.532369,-1.861511,-0.642761,-0.353049,-0.097507,1.375408,-0.221409,-0.520942,-1.276213,-1.616322,-0.123333,-1.058857,-1.617088,1.094219,-1.461155,-0.809879,-1.325804,1.491829,1.915274,-0.657058,-1.84234,-1.019881,0.596283,1.029973},
		{-0.819159,0.746148,-0.785724,-1.180721,-0.920759,-0.185076,1.485702,0.049737,-0.728135,-1.636765,0.085111,-0.473254,-0.961265,1.098692,-0.484731,-0.573583,1.638059,-1.69174,-1.413966,1.831901,0.887549,-0.026457,1.533034,0.638108,0.279835,-1.383041,0.317589,0.619083,0.789953,-0.522298,0.209139,-0.517105,-1.270333,-1.667323,-1.817869,1.598859,-1.641776,0.630906,-0.366682,-0.268929,0.797684,1.176322,1.390397,-1.648716,0.86473,1.153621,-0.005564,-1.347635,1.303375,1.866266},
		{-0.773268,-0.855091,1.341394,-1.002393,0.589594,1.079542,0.217964,1.575986,-0.792063,0.973145,1.870805,-0.660638,-1.961266,1.026699,-1.686021,1.001129,1.631906,1.629514,1.266776,1.481085,-1.16603,-0.041894,-0.538944,-1.55119,-0.39503,0.208097,0.189294,-1.633783,1.443253,1.626021,0.503957,1.612022,-1.775493,0.350562,1.527291,-1.318929,-0.888117,-1.144981,0.693412,1.076727,1.143793,-0.02675,1.712207,1.380788,0.493298,1.836807,-1.806092,1.383074,0.140584,0.543646},
		{-1.509482,-0.908706,-0.374042,-0.780131,-0.103442,0.360742,1.054797,0.416941,-1.057739,-0.120996,-1.046282,-0.492551,-0.815085,0.848738,0.054224,0.790464,-0.177967,-0.279766,0.446178,1.70517,-1.672241,-1.137443,-0.495675,1.865225,0.723349,-1.445707,-0.769346,-1.224809,-0.198589,-1.960855,1.129658,-0.870082,0.406937,-0.865033,-0.169062,-0.812064,1.24135,0.73917,1.593121,1.482682,0.96137,-1.037988,1.368532,1.729681,-0.087369,-0.073646,-0.918734,1.994192,-0.235416,-1.301076},
		{1.958238,0.899666,-1.75129,0.762234,-0.189703,1.829514,-1.326525,-1.583123,-0.448616,1.614179,0.566434,-0.824427,-1.132237,-0.341124,1.761258,1.654164,1.327162,1.219648,-0.589884,0.584314,1.570296,-1.124308,-0.189636,-1.671517,0.36992,1.081496,0.618837,0.422383,1.817063,-0.774103,-0.529628,0.963572,-1.529453,-1.394274,0.173052,-0.187145,-1.310354,-1.57475,-0.773287,0.440791,-0.668196,1.345522,0.507431,1.505659,-0.09668,0.362971,-0.530576,0.580514,-0.065762,1.81104},
		{-1.835246,-0.867491,1.688586,0.771402,1.663608,-0.765567,1.928421,1.817712,0.673946,-1.40052,1.48542,0.392952,-1.336368,0.095904,-0.72942,-1.496573,-0.92172,-1.22538,0.171764,-0.584735,1.403322,-1.678106,-0.699815,-1.819998,-0.608864,-1.918624,-0.278419,-1.516415,0.37462,-1.360493,-1.188639,-1.043934,0.307844,0.987887,0.884177,0.893315,-1.220586,-0.051256,-1.554701,0.219857,0.556974,-1.83111,1.93358,-1.931726,-1.946254,-1.028113,-0.897207,-1.501915,-0.486004,1.080865},
		{0.104285,-1.690425,-0.268437,-0.689867,0.742774,-0.032767,0.345961,-0.455398,0.091975,-0.026892,1.528549,0.055704,-0.853508,1.695921,-0.458211,-0.632333,1.365166,-0.090904,-1.434109,-0.462221,0.478271,-0.711382,-1.495704,1.11935,0.949433,-0.326464,-0.62857,-1.911363,-0.35582,1.413186,-0.980869,-0.055033,-1.385892,-1.139436,-1.979479,-0.33561,1.40104,0.878234,0.513618,-1.22666,0.702288,-1.101255,-0.676916,0.004476,-1.629526,1.878834,0.163878,-0.634458,-1.860378,-0.293297},
		{1.604702,-1.75356,-1.484431,-1.722161,-1.819445,-0.421746,1.230115,0.175588,-0.588899,-0.46976,1.943941,0.689671,0.078431,-0.963028,1.229899,-0.230045,0.777397,1.228452,0.724453,-0.518637,-1.066175,0.782381,1.474711,-0.785526,0.366043,-1.244377,0.557707,1.654653,0.301122,-0.270427,0.848312,1.813983,0.301603,-1.459723,1.177039,1.063035,-1.060939,1.893354,-0.162995,-1.316686,0.363085,1.889857,0.909434,-0.189836,0.221428,0.031111,1.36237,0.329453,-0.815279,1.410331},
		{-1.223322,-1.810685,-1.639591,0.076892,0.635562,-1.80098,-0.106731,1.098795,-0.93465,1.97519,0.756712,1.423654,-0.571249,0.456011,0.870008,0.445087,0.98141,1.986998,-0.902067,0.160293,0.71595,0.57337,-0.762171,-1.196781,-1.810277,-1.269905,1.256403,0.565224,0.822105,-0.487088,-1.998582,-1.836578,0.050293,0.542168,-1.675309,-0.39112,0.049155,1.837866,0.070918,1.205803,-1.809851,-1.910914,0.332672,-0.700224,0.637145,-1.697142,-0.804748,0.570015,-1.658093,-0.946528},
		{0.627306,0.041398,-0.767388,0.339376,-0.910916,0.967957,-1.58449,0.714453,1.238261,0.340642,-1.242491,0.229032,-1.04633,0.293265,1.30009,-1.27427,-1.512528,1.367811,-1.731247,1.232141,-0.706862,-0.315406,0.86601,0.282908,-1.293429,-1.738927,0.293073,0.17535,0.03459,-0.254006,0.725897,1.169281,0.598278,-0.628033,-0.128446,-0.334934,1.860716,-1.029075,0.156827,-1.531963,-0.051994,-1.043588,0.263228,0.634004,0.113341,0.767195,-1.577571,-0.479883,-1.027081,-1.50651}
	};

	static float W2_f[q][m1] = {{0.575573,-1.308225,-0.566823,-1.968666,0.281423,-1.797098,0.914605,1.365332,1.7654,-1.624024,1.257861,-1.507375,0.414552,-0.444838,-1.927423,-1.57441,0.806835,-0.339324,-0.272065,-1.773557}};

	static float b1_f[m1][1] = {
		{1.525417},
		{1.770761},
		{0.470763},
		{-0.881672},
		{1.751699},
		{-1.968351},
		{-1.00514},
		{-1.047989},
		{1.272453},
		{-0.060779},
		{-0.656991},
		{-1.292582},
		{0.166186},
		{1.961173},
		{1.143035},
		{0.32905},
		{0.867204},
		{0.284786},
		{-0.270486},
		{0.730952}
	};

	static float b2_f[q][1] = {{0.0000e+00}};

	static float Y_f[q][1] = {{1.0000e+00}};

	static float alpha_f[Array_dim * Tile_dim * 4][Array_dim * Tile_dim * 4] =
			{{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			{1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01, 1.0000e-01},
			};

	printf("MATRIX DEFINITION IS DONE! \n");

	FxP_Conversion(m1, p, W1_f, W1);
	FxP_Conversion(q, m1, W2_f, W2);
	FxP_Conversion(m1, 1, b1_f, b1);
	FxP_Conversion(q, 1, b2_f, b2);
	FxP_Conversion(q, 1, Y_f, Y);
	FxP_Conversion(Array_dim * Tile_dim * 4, Array_dim * Tile_dim * 4, alpha_f, alpha);
	printf("FIXED POINT CONVERSION IS DONE! \n");

	//X in R1, W1 in R2, b1 in R3, W2 in R4, b2 in R5, Y (output) in R10, alpha (learning rate) in R31
	WRITE_Matrix(p, 1, X, 1, m1); 									//X(50*1) in R1

	WRITE_Matrix(m1, p, W1, 2, 1); 									//W1(20*50) in R2
	WRITE_Matrix(q, m1, W2, 4, 1); 									//W2(1*20) in R4

	WRITE_Matrix(m1, 1, b1, 3, 0); 									//b1(20*1) in R3
	WRITE_Matrix(q, 1, b2, 5, 0); 									//b2(1*1) in R5

	WRITE_Matrix(q, 1, Y, 10, 0); 									//Y(1*1) in R10
	WRITE_Matrix(Array_dim * Tile_dim * 4, Array_dim * Tile_dim * 4, alpha, 31, 1); 								//alpha(4*4) in R31
	printf("WRITE Matrix IS DONE! \n");


	for( e = 0; e < epoch; e++) 												// On number of epochs for training
	{
		// MLP FORWARD
		MARTIX_MULTIPLICATION(1, 2, 6, p, Array_dim * Tile_dim);			//W1X in R6
		MARTIX_ADDITION(6, 3, 7);											//H = W1X + b1 in R7

		ColumnToRow(7, 7, 0);												// Momve H from last column of PEs to first row of PEs (preparing for the next layer)
		int instruction = (7<<26) + (7<<21) + (7<< 16) + (0 << 11);
		Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
		for( i=1; i<q; i++){
			Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
			Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
			ShS_cnt++;
		}

		MARTIX_MULTIPLICATION(4, 7, 8, m1, Array_dim * Tile_dim);			//W2H in R8
		MARTIX_ADDITION(8, 5, 9);											//Out = W2H + b2 in R9 [in last column]

		// MLP BACKWARD

		MARTIX_SUBTRACTION(9, 10, 11);										//dE_total/dOut_i = Out_i - Y_i in R11 [all in last column]

		ELEMENTWISE_MULTIPLICATION(31, 11, 29);								//Output Layer Bias Update
		MARTIX_SUBTRACTION(5, 29, 12);										//bias - alph * dE_total/dbias in R5 [in last column]


		//MARTIX_ADDITION(1, 9, 12);										//with AF: dOut_i/dnet_i (1-Out_i) TODO: change 1 to binary value
		//ELEMENTWISE_MULTIPLICATION(9, 12, 13);							//with AF: dOut_i/dnet_i Out_i*(1-Out_i) in R13
																			//dnet_i/dW = Out_i_1 in R7

		//ELEMENTWISE_MULTIPLICATION(11, 13, 11);							//with AF: dE_total/dW = dE_total/dOut_i * dOut_i/dnet_i * dnet_i/dW

		ColumnToColumn(11, 11, m1);
		ELEMENTWISE_MULTIPLICATION(11, 7, 15);								//dE_total/dW = dE_total/dOut_i * dOut_i/dnet_i * dnet_i/dW in R15


		ELEMENTWISE_MULTIPLICATION(31, 15, 17);								//alph * dE_total/dW in R17 [in first row]


		MARTIX_SUBTRACTION(4, 17, 13);										//W - alph * dE_total/dW in R13


		//dEi/dOut_H_i = dEi/dnet_i * dnet_i/dOut_H_i
		//ELEMENTWISE_MULTIPLICATION(11, 13, 19);							//with AF: dEi/dnet_i = dEi/dOut_i (R11) * dOut_i/dnet_i (R13) in R19
		MARTIX_ADDITION(11, 0, 19);											//w/o AF: dEi/dnet_i = dEi/dOut_i (R11) * 1 in R19
		//dnet_i/dOut_H_i (R4)


		ColumnToColumn(19, 19, m1);
		//Debugging: should not use the updated weights (R4), store R4 in another register for now, then move to R4 at the end
		ELEMENTWISE_MULTIPLICATION(19, 4, 20);								//dEi/dOut_H_i = dEi/dnet_i * dnet_i/dOut_H_i in R20
		MARTIX_ADDITION(20, 0, 21);											//just to copy R20 to R21
		for(i = 1; i < q; i++){
			execute(8, 22, 21, 0);
			execute(0, 21, 22, 20);											//dE_total/dOut_H_i in R21
		}

		RowToColumn(m1, 1, 29, 21);											// Hidden Layer Bias Update
		ELEMENTWISE_MULTIPLICATION(29, 31, 26);
		MARTIX_SUBTRACTION(3, 26, 14);										//bias - alph * dE_total/dbias in R14 [in last column]

		//MARTIX_ADDITION(1, 7, 22);										//with AF: TODO: change 1 to binary value
		//ELEMENTWISE_MULTIPLICATION(22, 7, 22);							//with AF: dOut_H_i/dnet_H_i in R22

		//dnet_H_i/dW in R1
		//ELEMENTWISE_MULTIPLICATION(21, 22, 23);								//with AF: dE_total/dW (R24) = dE_total/dOut_H_i (R21) * dOut_H_i/dnet_H_i (R22) * dnet_H_i/dW (R1)

		ColumnToColumn(29, 29, p);
		ELEMENTWISE_MULTIPLICATION(1, 29, 24);								//dE_total/dW (R24) = dE_total/dOut_H_i (R21) * dOut_H_i/dnet_H_i (R22) * dnet_H_i/dW (R1)


		ELEMENTWISE_MULTIPLICATION(24, 31, 27);								//alph * dE_total/dW in R27
		MARTIX_SUBTRACTION(2, 27, 15);										//W - alph * dE_total/dW in R15


		MARTIX_ADDITION(15, 0, 2);											//Replacing the updated weights and biases
		MARTIX_ADDITION(14, 0, 3);
		MARTIX_ADDITION(13, 0, 4);
		MARTIX_ADDITION(12, 0, 5);

		printf("Printing the PEs Register Files -------------------------------------------------------------------------\r\n");
		printf("-------------------------------------------------------------------------\r\n");
		printf("Tile(%d, %d): PE-Block(%d, %d): \n\r", 0, 0, 0, 0);
		printRegFile(0, 0, 0, 0, 32);

	} //end for epoch

//	printf("Number of ShR: %d \r\n", ShR_cnt);
//	printf("Number of ShL: %d \r\n", ShL_cnt);
//	printf("Number of ShN: %d \r\n", ShN_cnt);
//	printf("Number of ShS: %d \r\n", ShS_cnt);
//	printf("Number of add: %d \r\n", add_cnt);
//	printf("Number of mult: %d \r\n", mult_cnt);

    return 0;
}

void ColumnToColumn(int rd, int rs, int copy){

	int i;
	MB_Sleep(1);
	int instruction = (5<<26) + (rd<<21) + (rs<< 16) + (0 << 11);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
	//MB_Sleep(1);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	MB_Sleep(1);
	instruction = (5<<26) + (rd<<21) + (rs<< 16) + (1 << 11);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
	//MB_Sleep(1);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	MB_Sleep(1);

	for(i = 0; i < copy + 1; i++)
	{
		instruction = (11<<26) + (rd<<21) + (rs<< 16) + (0 << 11);
		Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
		//MB_Sleep(1);
		Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
		Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
		MB_Sleep(1);
	}

}

void RowToColumn(int rd, int rs, int function){

	//function: 0 == noOp, 1 == sigmoid, 2 == tanh
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG6_OFFSET, function);
	execute(8, rs, rs, 0);
	ShN_cnt++;
	int instruction = (6<<26) + (rd<<21) + (rs << 16) + (0 << 11);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	ShL_cnt++;
}

void ColumnToRow(int rd, int rs, int function){

	//function: 0 == noOp, 1 == sigmoid, 2 == tanh
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG6_OFFSET, function);
	execute(5, rs, rs, 0);
	ShR_cnt++;
	int instruction = (7<<26) + (rd<<21) + (rd << 16) + (0 << 11);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	ShS_cnt++;
}

void RowToRow(int rd, int rs){

	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG6_OFFSET, 0x6);
	execute(8, rs, rs, 0);
	ShN_cnt++;
	int instruction = (7<<26) + (rd<<21) + (rd << 16) + (0 << 11);

	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	ShS_cnt++;
}

void print2DArray(int rows, int cols, int arr[][cols]){

	int i, j;
	for( i=0; i<rows; i++){
		for( j=0; j<cols; j++){
			printf("%08x\t", arr[i][j]);
		}
		printf("\n\r");
	}
}

inline fixed_point_t float_to_fixed(double input)
{
    return (fixed_point_t)(input * (1 << FIXED_POINT_FRACTIONAL_BITS));
}

void FxP_Conversion(int row, int col, float in[][col], int out[][col] ){

	int s, t;
	for( s=0; s<row; s++)
	{
		for( t=0; t<col; t++)
		{
			out[s][t] = float_to_fixed(in[s][t]);
		}
	}
}

void ELEMENTWISE_MULTIPLICATION(int matrixA_reg, int matrixB_reg, int Result_Reg){

	execute(2,Result_Reg,matrixA_reg,matrixB_reg);
	mult_cnt++;
}

void MARTIX_ADDITION(int matrixA_reg, int matrixB_reg, int Result_Reg){

	execute(0,Result_Reg,matrixA_reg,matrixB_reg);
	add_cnt++;
}

void MARTIX_SUBTRACTION(int matrixA_reg, int matrixB_reg, int Result_Reg){

	execute(1,Result_Reg,matrixA_reg,matrixB_reg);
	sub_cnt++;
}

void MARTIX_MULTIPLICATION(int matrixA_reg, int matrixB_reg, int Result_Reg, int matrixA_col, int block_dimension){

	int i;
	execute(2,21,matrixB_reg,matrixA_reg);	//Mult
	mult_cnt++;
	execute(5,27,21,0);						//ShiftEast
	ShR_cnt++;
	execute(0,22,27,21);					//Add
	add_cnt++;
	//shift and add
	for( i = 0; i < matrixA_col-2; i++)
	{
		execute(5,23,22,0);					//ShiftEast
		ShR_cnt++;
		execute(0,22,23,21);				//Add
		add_cnt++;
	}
	//shift till edge
	for( i = 0; i < (block_dimension*4) - matrixA_col; i++)
	{
		execute(5,22,22,0);					//ShiftEast
		ShR_cnt++;
	}
	execute(0,Result_Reg,22,0);
	add_cnt++;
	return;

}

unsigned int Log2n(unsigned int n)
{
    return (n > 1) ? 1 + Log2n(n / 2) : 0;
}

void MARTIX_MULTIPLICATION_Optimized(int matrixA_reg, int matrixB_reg, int Result_Reg, int matrixA_col, int block_dimension){

	//Optimized with BinTree accumulation
	unsigned int log_colA = Log2n(matrixA_col);
	int col_cnt = 0;
	execute(2,21,matrixB_reg,matrixA_reg);	//Mult
	mult_cnt++;
	execute(0,23,21,0);						//Add
	add_cnt++;
	int i, j;
	for( i=0; i<log_colA; i++){
		execute(5,22,21,0);						//ShiftEast
		col_cnt++;
		ShR_cnt++;
		for( j=0; j<pow((double)2,(double)i)-1; j++){
			execute(5,22,22,0);						//ShiftEast
			col_cnt++;
			ShR_cnt++;
		}
		execute(0,21,22,21);					//Add
		add_cnt++;
	}
	if(col_cnt != matrixA_col -1)
	{
		//shift and add
		for( i = col_cnt; i < matrixA_col; i++)
		{
			execute(5,22,21,0);					//ShiftEast
			ShR_cnt++;
			execute(0,21,23,22);				//Add
			add_cnt++;
		}
	}

	//shift till edge
	for( i = 0; i < (block_dimension*4) - matrixA_col; i++)
	{
		execute(5,21,21,0);					//ShiftEast
		ShR_cnt++;
	}

	execute(0,Result_Reg,21,0);
	add_cnt++;
	return;

}

void WRITE_Matrix(int row, int col, int W[][col], int reg, int copy){

	int s, t, i;
	if (copy == 1)		//write a 2D array, starts from the left-most PEs
	{
		for( s=0; s<row; s++)
		{
			for( t=0; t<col; t++)
			{
				WRITE_REG(s/(4 * Tile_dim), t/(4 * Tile_dim), (s/4)%Tile_dim, (t/4)%Tile_dim, ((s*4+t)%4+s*4)%16, reg, W[s][t]);
			}
		}
	}
	else if(copy == 0)	//write a 1D array into last column PEs
	{
		for( s=0; s<row; s++)
		{
			for( t=0; t<col; t++)
			{
				WRITE_REG(s/(4 * Tile_dim), Array_dim-1, (s/4)%Tile_dim, Tile_dim-1, (s*4+3)%16, reg, W[s][t]);
			}
		}
	}
	else if(copy == -1)	//write a 1D array into first column PEs
	{
		for( s=0; s<row; s++)
		{
			for( t=0; t<col; t++)
			{
				WRITE_REG(0, s/Array_dim, 0, (s/4)%Tile_dim, s%4, reg, W[s][t]);
			}
		}
	}
	else				//write a 1D array into first row, copies to the below PEs too
	{
		for( s=0; s<row; s++)
		{
			for( t=0; t<col; t++)
			{
				WRITE_REG(s/(4 * Tile_dim), Array_dim-1, (s/4)%Tile_dim, Tile_dim-1, (s*4+3)%16, reg, W[s][t]);
			}
		}
		ColumnToRow(reg, reg, 0);

		int instruction = (7<<26) + (reg<<21) + (reg << 16) + (0 << 11);
		Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
		for( i = 0; i < copy-1; i++)
		{
			Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
			Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
		}

	}

}

void WRITE_Matrix_Large(int row, int col, int block_row, int block_col, int row_blk_size, int col_blk_size, int W[][col], int reg, int copy, int block_dimension){


	int ss, tt, s, t, i;
	if (copy == 1)		//write a 2D array, starts from the left-most PEs
	{
		for( s = row_blk_size * block_row; s < ((block_row + 1) * row_blk_size); s++)
		{
			for( t = col_blk_size * block_col; t < ((block_col + 1) * col_blk_size); t++)
			{
				ss = s - (row_blk_size * block_row);
				tt = t - (col_blk_size * block_col);
				WRITE_REG(ss/(4 * Tile_dim), tt/(4 * Tile_dim), (ss/4)%Tile_dim, (tt/4)%Tile_dim, ((ss*4+tt)%4+ss*4)%16, reg, W[s][t]);

			}
		}
	}
	else if(copy == 0)	//write a 1D array into last column PEs
	{
		for( s = row_blk_size * block_row; s < ((block_row + 1) * row_blk_size); s++)
		{
			for( t = col_blk_size * block_col; t < col; t++)
			{
				ss = s - (row_blk_size * block_row);
				tt = t - (col_blk_size * block_col);
				WRITE_REG(ss/(4 * Tile_dim), Array_dim-1, (ss/4)%Tile_dim, Tile_dim-1, (ss*4+3)%16, reg, W[s][t]);

			}
		}
	}
	else if(copy == -1)	//write a 1D array into first column PEs
	{
		for( s = row_blk_size * block_row; s < ((block_row + 1) * row_blk_size); s++)
		{
			for( t = col_blk_size * block_col; t < col; t++)
			{
				ss = s - (row_blk_size * block_row);
				tt = t - (col_blk_size * block_col);
				WRITE_REG(0, ss/Array_dim, 0, (ss/4)%Tile_dim, ss%4, reg, W[s][t]);
			}
		}
	}
	else				//write a 1D array into first row, copies to the below PEs too
	{
		for( s = row_blk_size * block_row; s < ((block_row + 1) * row_blk_size); s++)
		{
			for( t = col_blk_size * block_col; t < col; t++)
			{
				ss = s - (row_blk_size * block_row);
				tt = t - (col_blk_size * block_col);
				WRITE_REG(ss/(4 * Tile_dim), Array_dim-1, (ss/4)%Tile_dim, Tile_dim-1, (ss*4+3)%16, reg, W[s][t]);
			}
		}
		ColumnToRow(reg, reg, 0);

		int instruction = (7<<26) + (reg<<21) + (reg << 16) + (0 << 11);
		Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
		for( i = 0; i < copy-1; i++)
		{
			Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
			Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
		}

	}

}

int toggleBit(int n, int k){

    return (n ^ (1 << (k - 1)));
}

void WRITE_REG(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int PE, int reg, unsigned int data){

	int base = reg*32;
	int i;
	for( i=base-2; i>=base-33; i-=2){

		unsigned int dia = ((data<<(31-i))>>31)<<PE;
		unsigned int dib = ((data<<(31-i-1))>>31)<<PE;
		unsigned int tmp, oldDia, oldDib, newDia, newDib;
		tmp = READ(Tile_i, Tile_j, BRAM_i, BRAM_j, 32+i, 32+i+1);
		oldDia = tmp >> 16;
		oldDib = (tmp << 16) >> 16;
		char oldBitA = getbit(oldDia, PE);
		char oldBitB = getbit(oldDib, PE);
		char BitA = getbit(dia, PE);
		char BitB = getbit(dib, PE);
		newDia = dia|oldDia;
		if(BitA==0 && oldBitA==1) newDia = toggleBit(newDia, PE+1);

		newDib = dib|oldDib;
		if(BitB==0 && oldBitB==1) newDib = toggleBit(newDib, PE+1);

		WRITE(Tile_i, Tile_j, BRAM_i, BRAM_j, 32+i, 32+i+1, newDia, newDib);
	}
}

unsigned int READ_REG(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int PE, int reg){

	int base = reg*32;
	unsigned int out;
	for(int i=base-2; i>=base-33; i-=2){

		unsigned int tmp, oldDia, oldDib;
		tmp = READ(Tile_i, Tile_j, BRAM_i, BRAM_j, 32+i, 32+i+1);
		oldDia = tmp >> 16;
		oldDib = (tmp << 16) >> 16;
		int oldBitA = getbit(oldDia, PE);
		int oldBitB = getbit(oldDib, PE);
		out = out << 1;
		out = out + oldBitB;
		out = out << 1;
		out = out + oldBitA;
	}
	return out;
}

void WRITE(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int ADDRA, int ADDRB, int DIA, int DIB){

	int reg7_input = (Tile_i << 16) + Tile_j;
	int reg2_input = (BRAM_i << 16) + BRAM_j;
	int reg3_input = (ADDRA << 16) + ADDRB;
	int reg4_input = (DIA << 16) + DIB;

	//Tile_i = 0, Tile_j = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG7_OFFSET, reg7_input);

	//BRAM_i = 0, BRAM_j = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG2_OFFSET, reg2_input);

	//ADDRA = 32 , ADDRB = 64
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG3_OFFSET, reg3_input);

	//DIA = 0xFFFF, DIB = 0x1111
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG4_OFFSET, reg4_input);

	//external = 1, WEA = 1, WEB = 1
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x0000001D+LEN);

	//external = 1, WEA = 0, WEB = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG7_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG2_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG3_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG4_OFFSET, 0x00000000);

}

int READ(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int ADDRA, int ADDRB){

	int reg7_input = (Tile_i << 16) + Tile_j;
	int reg2_input = (BRAM_i << 16) + BRAM_j;
	int reg3_input = (ADDRA << 16) + ADDRB;

	int DO;

	//Tile_i = 0, Tile_j = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG7_OFFSET, reg7_input);

	//BRAM_i = 0, BRAM_j = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG2_OFFSET, reg2_input);

	//ADDRA = 32 , ADDRB = 64
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG3_OFFSET, reg3_input);

	//external = 1, WEA = 0, WEB = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000005+LEN);

	//read
	DO = Bit_Serial_mReadReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG5_OFFSET);

	//external = 1, WEA = 0, WEB = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG7_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG2_OFFSET, 0x00000000);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG3_OFFSET, 0x00000000);

	return DO;
}

int printReg(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int PE, int reg){

	int REG[32];
	int reg_out;
	int DO;
	reg = reg << 5;
	int i;
	for( i=0; i<16; i++){
		DO = READ (Tile_i, Tile_j, BRAM_i, BRAM_j, reg+i, reg+i+16);
		REG[i+16] = getbit(DO, PE);
		REG[i] = getbit(DO, PE+16);
	}

	reg_out = getTrans(REG);

	return reg_out;
}

void printRegFile(int Tile_i, int Tile_j, int BRAM_i, int BRAM_j, int number_of_regs){

	int PE, i;
	for( PE=0; PE<16; PE++){
		for( i=number_of_regs-1; i>=0; i--)
		{
			printf("%08x \t", printReg(Tile_i, Tile_j, BRAM_i, BRAM_j, PE, i));
		}
		printf("\n\r");
	}

}

int execute(int opcode, int rd, int rs1, int rs2)
{
	int instruction = (opcode<<26) + (rd<<21) + (rs1 << 16) + (rs2 << 11);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000000+LEN);//start = 0, reset = 0
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG0_OFFSET, instruction);//instruction
	MB_Sleep(1);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	MB_Sleep(1);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000003+LEN);//start = 1, reset = 1
	MB_Sleep(1);
	Bit_Serial_mWriteReg(XPAR_Bit_Serial_0_S00_AXI_BASEADDR, Bit_Serial_S00_AXI_SLV_REG1_OFFSET, 0x00000001+LEN);//start = 0, reset = 1
	MB_Sleep(1);
	return 0;
}

int getbit(int n, int k){

	return (n & ( 1 << k )) >> k;
}

void printArray(int* arr, int size){

	int i;
	for(i=0; i<size; i++){
		printf("%x\n\r",arr[i]);
	}
}

void getTranspose(int* ram, int* reg){

	int i, j;
	for(j=0; j<16; j++){
		for(i=31; i>=0; i--){
			reg[j] <<= 1;
			if(getbit(ram[i],j)==1) reg[j]++;
		}
	}
}

int getTrans(int* ram){

	int reg = 0;
	int i;
	for(i=31; i>=0; i--){
		reg <<= 1;
		getbit(ram[i],0)==1? reg++ : reg;
	}
	return reg;

}

void getData(int* arr, int address){

	int i;
	for(i=0; i<32; i++){
		init_platform();
		arr[i] = readRAM(address+i);
		cleanup_platform();
	}
}

/*void RowToRowCopy(int row, int col, int rd, int rs, int copy){

	//read a 1D array from first row PEs and copy to next rows
	int s, t, k;
	unsigned int tmp;
	for( s=0; s<row; s++)
	{
		for( t=0; t<col; t++)
		{
			tmp = READ_REG(0, s/(4 * Tile_dim), 0, (s/4)%Tile_dim, s%4, rs);
			for( k=1; k<=copy; k++)
			{
				WRITE_REG(k/(4 * Tile_dim), s/(4 * Tile_dim), (k/4)%Tile_dim, (s/4)%Tile_dim, ((k*4+s)%4+k*4)%16, rd, tmp);
				//printf("Tile(%d, %d), PE-Block(%d, %d), PE: %d, W[%d][%d]: %08x \n\r", k/(4 * Tile_dim), s/(4 * Tile_dim), (k/4)%Tile_dim, (s/4)%Tile_dim, ((k*4+s)%4+k*4)%16, k, s, tmp);
			}
		}
	}
}*/

/*void ColumnToColumn(int row, int col, int rd, int rs, int copy){

	//read a 1D array from last column PEs and write it to the first column PEs and copy to next columns
	int s, t, k;
	unsigned int tmp;
	for( s=0; s<row; s++)
	{
		for( t=0; t<col; t++)
		{
			tmp = READ_REG(s/(4 * Tile_dim), Array_dim-1, (s/4)%Tile_dim, Tile_dim-1, (s*4+3)%16, rs);
			for( k=0; k<copy; k++)
			{
				WRITE_REG(s/(4 * Tile_dim), k/(4 * Tile_dim), (s/4)%Tile_dim, (k/4)%Tile_dim, ((s*4+k)%4+s*4)%16, rd, tmp);
			}
		}
	}
}*/
/*void RowToColumn(int row, int col, int rd, int rs){

	//read a 1D array from first row PEs and write it to the last column PEs
	int s, t, k;
	unsigned int tmp;
	for( s=0; s<row; s++)
	{
		for( t=0; t<col; t++)
		{
			tmp = READ_REG(0, s/(4 * Tile_dim), 0, (s/4)%Tile_dim, s%4, rs);
			WRITE_REG(s/(4 * Tile_dim), Array_dim-1, (s/4)%Tile_dim, Tile_dim-1, (s*4+3)%16, rd, tmp);
		}
	}
}*/